<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì½”ì¹˜ WOD ê´€ë¦¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            color: #333;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
        }

        .header {
            background: #4F46E5;
            color: white;
            padding: 1rem;
            text-align: center;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #ddd;
        }

        .nav-tab {
            flex: 1;
            padding: 1rem;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .nav-tab.active {
            background: #f0f0f0;
            font-weight: bold;
        }

        .content {
            padding: 1rem;
        }

        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #ddd;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .calendar-header {
            background: #4F46E5;
            color: white;
            padding: 0.5rem;
            text-align: center;
            font-size: 0.8rem;
        }

        .calendar-day {
            background: white;
            padding: 0.5rem;
            text-align: center;
            cursor: pointer;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .calendar-day:hover {
            background: #f0f0f0;
        }

        .calendar-day.today {
            background: #e3f2fd;
            color: #1976d2;
            font-weight: bold;
        }

        .calendar-day.selected {
            background: #4F46E5;
            color: white;
        }

        .calendar-day.has-wod {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .month-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .month-nav button {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn {
            background: #4F46E5;
            color: white;
            border: none;
            padding: 0.75rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
        }

        .btn:hover {
            background: #3730a3;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-group textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
            resize: vertical;
        }

        .empty-state {
            text-align: center;
            padding: 2rem 1rem;
            color: #666;
        }

        .quick-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .quick-actions button {
            flex: 1;
            padding: 0.5rem;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
        }

        .wod-display {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .level-section {
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .level-section.beginner {
            background: #e8f5e8;
            border-color: #4caf50;
        }

        .level-section.intermediate {
            background: #fff3e0;
            border-color: #ff9800;
        }

        .level-section.advanced {
            background: #ffebee;
            border-color: #f44336;
        }

        .level-title {
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        @media (max-width: 480px) {
            .container {
                margin: 0;
            }

            .content {
                padding: 0.5rem;
            }

            .calendar-day {
                min-height: 35px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‹ï¸ ì½”ì¹˜ WOD ê´€ë¦¬</h1>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showView('calendar')">ğŸ“… ìº˜ë¦°ë”</button>
            <button class="nav-tab" onclick="showView('today')">ğŸ“ ì˜¤ëŠ˜</button>
        </div>

        <div class="content">
            <!-- ìº˜ë¦°ë” ë·° -->
            <div id="calendar-view" class="view active">
                <div class="month-nav">
                    <button onclick="changeMonth(-1)">â† ì´ì „</button>
                    <h2 id="current-month">2025ë…„ 8ì›”</h2>
                    <button onclick="changeMonth(1)">ë‹¤ìŒ â†’</button>
                </div>
                <div class="calendar" id="calendar"></div>
                <div id="selected-date-wod"></div>
            </div>

            <!-- ì˜¤ëŠ˜ ë·° -->
            <div id="today-view" class="view">
                <div id="today-wod-display"></div>
            </div>

            <!-- WOD í¸ì§‘ í¼ -->
            <div id="edit-view" class="view">
                <h3 id="form-title">WOD ì‘ì„±</h3>
                
                <div class="form-group">
                    <label for="workout-time">â±ï¸ ì›Œí¬ì•„ì›ƒ ì‹œê°„</label>
                    <textarea id="workout-time" rows="2" placeholder="ì˜ˆ: (20/10x8)6, AMRAP 20ë¶„"></textarea>
                </div>

                <div class="form-group">
                    <label for="conditioning">ğŸ’ª ì»¨ë””ì…”ë‹ ë©”ë‰´</label>
                    <textarea id="conditioning" rows="4" placeholder="ì˜¤ëŠ˜ì˜ ë©”ì¸ ìš´ë™"></textarea>
                </div>

                <div class="form-group">
                    <label for="monthly-mission">ğŸ¯ ì›”ë³„ ë¯¸ì…˜</label>
                    <textarea id="monthly-mission" rows="3" placeholder="ì´ë²ˆ ë‹¬ ì§‘ì¤‘ ëª©í‘œ"></textarea>
                </div>

                <div class="level-section beginner">
                    <div class="level-title">ğŸŸ¢ ì´ˆê¸‰ì ì§€ë„ ë°©í–¥</div>
                    <textarea id="beginner-notes" rows="3" placeholder="ì´ˆê¸‰ìë¥¼ ìœ„í•œ ì§€ë„ì‚¬í•­"></textarea>
                </div>

                <div class="level-section intermediate">
                    <div class="level-title">ğŸŸ¡ ì¤‘ê¸‰ì ì§€ë„ ë°©í–¥</div>
                    <textarea id="intermediate-notes" rows="3" placeholder="ì¤‘ê¸‰ìë¥¼ ìœ„í•œ ì§€ë„ì‚¬í•­"></textarea>
                </div>

                <div class="level-section advanced">
                    <div class="level-title">ğŸ”´ ê³ ê¸‰ì ì§€ë„ ë°©í–¥</div>
                    <textarea id="advanced-notes" rows="3" placeholder="ê³ ê¸‰ìë¥¼ ìœ„í•œ ì§€ë„ì‚¬í•­"></textarea>
                </div>

                <div class="form-group">
                    <label for="general-notes">ğŸ“ ì „ì²´ í´ë˜ìŠ¤ ë©”ëª¨</label>
                    <textarea id="general-notes" rows="3" placeholder="ì¶œì„, ì»¨ë””ì…˜ ë“±"></textarea>
                </div>

                <div class="quick-actions">
                    <button onclick="cancelEdit()">ì·¨ì†Œ</button>
                    <button onclick="saveWod()">ì €ì¥</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('ğŸ“± ì•± ì‹œì‘!');
        
        // ì „ì—­ ë³€ìˆ˜
        let currentDate = new Date();
        let selectedDate = null;
        let currentView = 'calendar';

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í•¨ìˆ˜
        function loadWods() {
            const saved = localStorage.getItem('coach-wods');
            return saved ? JSON.parse(saved) : {};
        }

        function saveWods(wods) {
            localStorage.setItem('coach-wods', JSON.stringify(wods));
        }

        // ë‚ ì§œ í¬ë§· í•¨ìˆ˜
        function formatDate(date) {
            return date.toISOString().split('T')[0];
        }

        function formatDateKorean(date) {
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'short' };
            return date.toLocaleDateString('ko-KR', options);
        }

        // ë·° ì „í™˜
        function showView(viewName) {
            console.log('ë·° ì „í™˜:', viewName);
            
            // ëª¨ë“  ë·° ìˆ¨ê¸°ê¸°
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // ì„ íƒëœ ë·° í‘œì‹œ
            const targetView = document.getElementById(viewName + '-view');
            if (targetView) {
                targetView.classList.add('active');
            }
            
            // í•´ë‹¹ íƒ­ í™œì„±í™”
            event.target.classList.add('active');
            
            currentView = viewName;

            if (viewName === 'today') {
                showTodayWod();
            }
        }

        // ìº˜ë¦°ë” ë Œë”ë§
        function renderCalendar() {
            console.log('ìº˜ë¦°ë” ë Œë”ë§');
            
            const calendar = document.getElementById('calendar');
            const monthElement = document.getElementById('current-month');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            monthElement.textContent = `${year}ë…„ ${month + 1}ì›”`;
            
            // ìº˜ë¦°ë” ì´ˆê¸°í™”
            calendar.innerHTML = '';
            
            // ìš”ì¼ í—¤ë”
            const weekdays = ['ì¼', 'ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† '];
            weekdays.forEach(day => {
                const header = document.createElement('div');
                header.className = 'calendar-header';
                header.textContent = day;
                calendar.appendChild(header);
            });
            
            // ë‚ ì§œ ê³„ì‚°
            const firstDay = new Date(year, month, 1);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            const wods = loadWods();
            const today = new Date();
            
            // 6ì£¼ê°„ í‘œì‹œ (42ì¼)
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = date.getDate();
                
                const dateStr = formatDate(date);
                
                // ì˜¤ëŠ˜ í‘œì‹œ
                if (formatDate(date) === formatDate(today)) {
                    dayElement.classList.add('today');
                }
                
                // WOD ìˆëŠ” ë‚  í‘œì‹œ
                if (wods[dateStr]) {
                    dayElement.classList.add('has-wod');
                }
                
                // ì„ íƒëœ ë‚  í‘œì‹œ
                if (selectedDate && formatDate(date) === selectedDate) {
                    dayElement.classList.add('selected');
                }
                
                // í´ë¦­ ì´ë²¤íŠ¸
                dayElement.addEventListener('click', () => {
                    selectDate(dateStr);
                });
                
                calendar.appendChild(dayElement);
            }
        }

        // ë‚ ì§œ ì„ íƒ
        function selectDate(dateStr) {
            console.log('ë‚ ì§œ ì„ íƒ:', dateStr);
            selectedDate = dateStr;
            renderCalendar();
            showSelectedDateWod();
        }

        // ì„ íƒëœ ë‚ ì§œ WOD í‘œì‹œ
        function showSelectedDateWod() {
            const container = document.getElementById('selected-date-wod');
            const wods = loadWods();
            const wod = wods[selectedDate];
            
            if (wod) {
                container.innerHTML = `
                    <div class="wod-display">
                        <h3>${formatDateKorean(new Date(selectedDate))} WOD</h3>
                        
                        ${wod.workoutTime ? `<p><strong>â±ï¸ ì‹œê°„:</strong> ${wod.workoutTime}</p>` : ''}
                        ${wod.conditioning ? `<p><strong>ğŸ’ª ìš´ë™:</strong><br>${wod.conditioning}</p>` : ''}
                        ${wod.monthlyMission ? `<p><strong>ğŸ¯ ë¯¸ì…˜:</strong> ${wod.monthlyMission}</p>` : ''}
                        
                        ${wod.levels && wod.levels.beginner ? `
                            <div class="level-section beginner">
                                <div class="level-title">ğŸŸ¢ ì´ˆê¸‰ì</div>
                                <div>${wod.levels.beginner}</div>
                            </div>
                        ` : ''}
                        
                        ${wod.levels && wod.levels.intermediate ? `
                            <div class="level-section intermediate">
                                <div class="level-title">ğŸŸ¡ ì¤‘ê¸‰ì</div>
                                <div>${wod.levels.intermediate}</div>
                            </div>
                        ` : ''}
                        
                        ${wod.levels && wod.levels.advanced ? `
                            <div class="level-section advanced">
                                <div class="level-title">ğŸ”´ ê³ ê¸‰ì</div>
                                <div>${wod.levels.advanced}</div>
                            </div>
                        ` : ''}
                        
                        ${wod.generalNotes ? `<p><strong>ğŸ“ ë©”ëª¨:</strong><br>${wod.generalNotes}</p>` : ''}
                        
                        <div class="quick-actions">
                            <button onclick="editWod('${selectedDate}')">ìˆ˜ì •</button>
                            <button onclick="deleteWod('${selectedDate}')">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>ìš´ë™ í”„ë¡œê·¸ë¨ì´ ì—†ìŠµë‹ˆë‹¤</h3>
                        <p>ì´ ë‚ ì§œì— WODë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”.</p>
                        <button class="btn" onclick="editWod('${selectedDate}')">WOD ì¶”ê°€</button>
                    </div>
                `;
            }
        }

        // ì˜¤ëŠ˜ WOD í‘œì‹œ
        function showTodayWod() {
            const container = document.getElementById('today-wod-display');
            const today = formatDate(new Date());
            const wods = loadWods();
            const wod = wods[today];
            
            if (wod) {
                container.innerHTML = `
                    <div class="wod-display">
                        <h3>ğŸ“… ${formatDateKorean(new Date())} WOD</h3>
                        
                        ${wod.workoutTime ? `<p><strong>â±ï¸ ì‹œê°„:</strong> ${wod.workoutTime}</p>` : ''}
                        ${wod.conditioning ? `<p><strong>ğŸ’ª ìš´ë™:</strong><br>${wod.conditioning}</p>` : ''}
                        ${wod.monthlyMission ? `<p><strong>ğŸ¯ ë¯¸ì…˜:</strong> ${wod.monthlyMission}</p>` : ''}
                        
                        ${wod.levels && wod.levels.beginner ? `
                            <div class="level-section beginner">
                                <div class="level-title">ğŸŸ¢ ì´ˆê¸‰ì</div>
                                <div>${wod.levels.beginner}</div>
                            </div>
                        ` : ''}
                        
                        ${wod.levels && wod.levels.intermediate ? `
                            <div class="level-section intermediate">
                                <div class="level-title">ğŸŸ¡ ì¤‘ê¸‰ì</div>
                                <div>${wod.levels.intermediate}</div>
                            </div>
                        ` : ''}
                        
                        ${wod.levels && wod.levels.advanced ? `
                            <div class="level-section advanced">
                                <div class="level-title">ğŸ”´ ê³ ê¸‰ì</div>
                                <div>${wod.levels.advanced}</div>
                            </div>
                        ` : ''}
                        
                        ${wod.generalNotes ? `<p><strong>ğŸ“ ë©”ëª¨:</strong><br>${wod.generalNotes}</p>` : ''}
                        
                        <button class="btn" onclick="editWod('${today}')">ìˆ˜ì •í•˜ê¸°</button>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>ğŸ“… ${formatDateKorean(new Date())}</h3>
                        <p>ì˜¤ëŠ˜ì˜ ìš´ë™ í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë³´ì„¸ìš”!</p>
                        <button class="btn" onclick="editWod('${today}')">ì˜¤ëŠ˜ WOD ì‘ì„±</button>
                    </div>
                `;
            }
        }

        // WOD í¸ì§‘
        function editWod(dateStr) {
            console.log('WOD í¸ì§‘:', dateStr);
            selectedDate = dateStr;
            
            // í¸ì§‘ ë·°ë¡œ ì „í™˜
            showView('edit');
            
            // ê¸°ì¡´ ë°ì´í„° ë¡œë“œ
            const wods = loadWods();
            const wod = wods[dateStr] || {
                workoutTime: '',
                conditioning: '',
                monthlyMission: '',
                levels: { beginner: '', intermediate: '', advanced: '' },
                generalNotes: ''
            };
            
            // í¼ì— ë°ì´í„° ì„¤ì •
            setTimeout(() => {
                try {
                    document.getElementById('workout-time').value = wod.workoutTime || '';
                    document.getElementById('conditioning').value = wod.conditioning || '';
                    document.getElementById('monthly-mission').value = wod.monthlyMission || '';
                    document.getElementById('beginner-notes').value = wod.levels.beginner || '';
                    document.getElementById('intermediate-notes').value = wod.levels.intermediate || '';
                    document.getElementById('advanced-notes').value = wod.levels.advanced || '';
                    document.getElementById('general-notes').value = wod.generalNotes || '';
                    
                    document.getElementById('form-title').textContent = 
                        `${formatDateKorean(new Date(dateStr))} WOD ${wod.conditioning ? 'ìˆ˜ì •' : 'ì‘ì„±'}`;
                    
                    console.log('í¼ ë°ì´í„° ì„¤ì • ì™„ë£Œ');
                } catch (error) {
                    console.error('í¼ ì„¤ì • ì—ëŸ¬:', error);
                }
            }, 100);
        }

        // WOD ì €ì¥
        function saveWod() {
            console.log('WOD ì €ì¥');
            
            const wods = loadWods();
            
            const wodData = {
                workoutTime: document.getElementById('workout-time').value,
                conditioning: document.getElementById('conditioning').value,
                monthlyMission: document.getElementById('monthly-mission').value,
                levels: {
                    beginner: document.getElementById('beginner-notes').value,
                    intermediate: document.getElementById('intermediate-notes').value,
                    advanced: document.getElementById('advanced-notes').value
                },
                generalNotes: document.getElementById('general-notes').value,
                lastModified: new Date().toISOString()
            };
            
            wods[selectedDate] = wodData;
            saveWods(wods);
            
            // ì´ì „ ë·°ë¡œ ëŒì•„ê°€ê¸°
            if (formatDate(new Date()) === selectedDate) {
                showView('today');
            } else {
                showView('calendar');
                renderCalendar();
                showSelectedDateWod();
            }
        }

        // í¸ì§‘ ì·¨ì†Œ
        function cancelEdit() {
            if (formatDate(new Date()) === selectedDate) {
                showView('today');
            } else {
                showView('calendar');
            }
        }

        // WOD ì‚­ì œ
        function deleteWod(dateStr) {
            if (confirm('ì •ë§ë¡œ ì´ WODë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                const wods = loadWods();
                delete wods[dateStr];
                saveWods(wods);
                renderCalendar();
                showSelectedDateWod();
            }
        }

        // ì›” ë³€ê²½
        function changeMonth(delta) {
            currentDate.setMonth(currentDate.getMonth() + delta);
            renderCalendar();
        }

        // ì•± ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ì•± ì´ˆê¸°í™” ì‹œì‘');
            
            renderCalendar();
            
            // ì˜¤ëŠ˜ ë‚ ì§œ ìë™ ì„ íƒ
            const today = formatDate(new Date());
            selectDate(today);
            
            console.log('ì•± ì´ˆê¸°í™” ì™„ë£Œ');
        });
    </script>
</body>
</html>